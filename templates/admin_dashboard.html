{% extends 'layout.html' %}
{% block content %}
<div class="container mt-4">
  <h1 class="mb-5 text-center">Admin Dashboard</h1>

  <!-- Welcome Message -->
  <div class="alert alert-info text-center">
    Welcome, {{ current_user.username }} ({{ current_user.email }})
  </div>

  <!-- Pending Articles Section -->
  <div class="mb-5">
    <h3 class="mb-3 text-primary">Pending Articles</h3>
    {% if articles %}
      {% for article in articles %}
        <div class="card mb-3 shadow-sm">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>
              <strong>
                <a href="{{ url_for('view_article', article_id=article.id) }}">
                  {{ article.title }}
                </a>
              </strong><br>
              <small>by {{ article.author }}</small>
            </div>
            <div>
              <a href="{{ url_for('approve_article', article_id=article.id) }}" class="btn btn-sm btn-success">Approve</a>
              <a href="{{ url_for('disapprove_article', article_id=article.id) }}" class="btn btn-sm btn-danger">Disapprove</a>
            </div>
          </div>
          <div class="card-body">
            {{ article.content[:250] }}...
            <div class="mt-2">
              <a href="{{ url_for('view_article', article_id=article.id) }}" class="btn btn-sm btn-outline-primary">Read Full Article</a>
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-muted">No pending articles.</p>
    {% endif %}

    <div class="pagination">
      {% if articles.has_prev %}
        <a href="{{ url_for('admin_dashboard', pending_page=articles.prev_num, approved_page=approved_articles.page) }}">Previous</a>
      {% endif %}

      Page {{ articles.page }} of {{ articles.pages }}

      {% if articles.has_next %}
        <a href="{{ url_for('admin_dashboard', pending_page=articles.next_num, approved_page=approved_articles.page) }}">Next</a>
      {% endif %}
    </div>

  </div>

  <!-- Approved Articles Section -->
  <div>
    <h3 class="mb-3 text-success">Approved Articles</h3>
    {% if approved_articles %}
      {% for article in approved_articles %}
        <div class="card mb-3 shadow-sm border-success">
          <div class="card-header bg-success text-white">
            {{ article.title }} by {{ article.author }}
          </div>
          <div class="card-body">
            {{ article.content[:250] }}...
            <div class="mt-2">
              <a href="{{ url_for('view_article', article_id=article.id) }}" class="btn btn-sm btn-outline-primary">Read Full Article</a>
            </div>
            <div>
              <a href="{{ url_for('disapprove_article', article_id=article.id) }}" class="btn btn-sm btn-danger">Delete</a>
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-muted">No approved articles yet.</p>
    {% endif %}
  </div>

    <div class="pagination">
      {% if approved_articles.has_prev %}
        <a href="{{ url_for('admin_dashboard', approved_page=approved_articles.prev_num, pending_page=articles.page) }}">Previous</a>
      {% endif %}

      Page {{ approved_articles.page }} of {{ approved_articles.pages }}

      {% if approved_articles.has_next %}
        <a href="{{ url_for('admin_dashboard', approved_page=approved_articles.next_num, pending_page=articles.page) }}">Next</a>
      {% endif %}
    </div>

</div>

{% endblock %}
